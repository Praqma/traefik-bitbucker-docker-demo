########### Upgrade Postgres database and Bitbucket ###########

# Always Run backup.sh prior to upgrade.
./backup.sh

# Bring everything down
docker-compose -f postgres-compose.yml -f bitbucket-compose.yml down

# To upgrade the postgres database.
- Change the image version in the postgres-compose.yml file.
- Delete the postgres database volume: `docker volume rm bitbucket_db`
- Bring the new version of Postgres up: `docker-compose -f postgres-compose.yml up -d`
- Restore database dump to the new version: `docker exec -it postgres-bitbucket psql -U bitbucket --dbname=bitbucket < "Name of backup sql file"`

# To upgrade the bitbucket version.
- Change the image version in the bitbucket-compose.yml file.
- Bring the new version of Bitbucket up: `docker-compose -f bitbucket-compose.yml up -d`

########### Other things ###########
# Restore Bitbucket data
- Restore from tarball: `docker run --rm -v bitbucket_data:/recover -v $(pwd):/backup alpine sh -c "cd /recover && tar xzvf /backup/Name of .tar.gz file"`
